# Variational Autoencoder (VAE) Configuration

# Encoder
encoder:
  # [from, number, module, args]
  [
    [-1, 1, Conv2d, [3, 32, 5, 1, 2]],
    [-1, 1, BatchNorm2d, [32]],
    [-1, 1, LeakyReLU, []],

    [-1, 1, Conv2d, [32, 32, 3, 2, 1]],
    [-1, 1, BatchNorm2d, [32]],
    [-1, 1, LeakyReLU, []],

    [-1, 1, Conv2d, [32, 64, 3, 2, 1]],
    [-1, 1, BatchNorm2d, [64]],
    [-1, 1, LeakyReLU, []],

    [-1, 1, Conv2d, [64, 128, 3, 2, 1]],
    [-1, 1, BatchNorm2d, [128]],
    [-1, 1, LeakyReLU, []],

    [-1, 1, Conv2d, [128, 256, 3, 2, 1]],
    [-1, 1, BatchNorm2d, [256]],
    [-1, 1, LeakyReLU, []],

    [-1, 1, Flatten, []],

  ]

# Latent space
latent_space:
  [
    [-1, 1, Linear, [ 1024, 1024]],  # Fully connected layer
  ]

# Decoder
decoder:
  [

    [ -1, 1, Linear, [ 1024, 1024] ],
    [ -1, 1, LeakyReLU, [] ],

    [-1, 1, Unflatten, [1, [256, 2, 2]]],

    [-1, 1, ConvTranspose2d, [256, 128, 3, 2, 1, 1]],
    [-1, 1, BatchNorm2d, [128]],
    [-1, 1, LeakyReLU, []],

    [-1, 1, ConvTranspose2d, [128, 64, 3, 2, 1, 1]],
    [-1, 1, BatchNorm2d, [64]],
    [-1, 1, LeakyReLU, []],

    [-1, 1, ConvTranspose2d, [64, 32, 3, 2, 1, 1]],
    [-1, 1, BatchNorm2d, [32]],
    [-1, 1, LeakyReLU, []],

    [-1, 1, ConvTranspose2d, [32, 32, 3, 2, 1, 1]],
    [-1, 1, BatchNorm2d, [32]],
    [-1, 1, LeakyReLU, []],

    [-1, 1, ConvTranspose2d, [32, 3, 3, 1, 1, 0]],
    [-1, 1, BatchNorm2d, [3]],
    [-1, 1, LeakyReLU, []],
  ]
